---
---
![design]({{ site.url }}/assets/20170801/bayes.png)

设定a,b是相关事件，贝叶斯定理如下：
```p(a|b)=p(a)*p(b|a)/p(b)```
公式很简单，但是使用场景很广。只要涉及概率问题，都可以尝试使用贝叶斯公式建模。下面举几个例子。

1.教科书中的例子

>一所学校里面有 60% 的男生，40% 的女生。男生总是穿长裤，女生则一半穿长裤一半穿裙子。有了这些信息之后我们可以容易地计算“随机选取一个学生，他（她）穿长裤的概率和穿裙子的概率是多大”，这个就是前面说的“正向概率”的计算。然而，假设你走在校园中，迎面走来一个穿长裤的学生（很不幸的是你高度近似，你只看得见他（她）穿的是否长裤，而无法确定他（她）的性别），你能够推断出他（她）是男生的概率是多大吗？

设定b(boy)表示男生，g(girl)表示女生，s(skirt)表示裙子，t(trouser)表示长裤。那么该问题，用贝叶斯定理求解。

```p(b|t)
  =p(b)p(t|b)/p(t)
  =[p(b)p(t|b)]/[p(b)b(t|b)+p(g)p(t|g)]
  =(60%*100%)/(60%*100%+40%*50%)
  =75%```

表示如果穿长裤，有75%的可能性是男生。

2.拼写纠正

如果用户输入了一个词，这个词在字典中查不到，那么用户最有可能想输入的词是什么?
![design]({{ site.url }}/assets/20170801/spelling.png)
这是一个概率问题，因为不可能确定用户真正想要输入的词(只有用户当时自己知道)，但是有没有一种方法能够推测出极有可能的词呢？
下面使用贝叶斯定理试试看。设定c是用户想要输入的词，w是用户输错的词，p(c|w)表示在输入错词w的情况下，用户想要输入的词c的概率。我们只需要让p(c|w)值最大，就可以找到最有可能的正确的词c。根据贝叶斯定理，可以得到
```p(c|w)=p(c)*p(w|c)/p(w)```
当用户输入错词后，p(w)的值其实已经确定了，所以可以认为p(w)是个常量。p(c)可以用语料库中词c出现的概率表示（尽量选择比较大的语料库，这样统计的会比较准。如果能有baidu，google这样的搜索巨头提供的用户搜索词库就更好了）。对于p(w|c)，根据常识，可以认为如果w和c越接近，p(w|c)的概率越大。因此，通过选择和w相近的词c1，c2，...，cn，分别计算其p(ci|w)的值，最大的那个词ci就是用户最有可能输入的。
实际上google就是基于贝叶斯做的拼写判断。

3.过滤垃圾邮件

下图是foxmai使用贝叶斯过滤垃圾邮件的配置。
![design]({{ site.url }}/assets/20170801/foxmail.png)

垃圾邮件过滤也是一个概率问题，因为机器不可能完全确定一个邮件肯定是垃圾邮件，它只能计算出这封邮件是垃圾邮件的概率。如果概率大于一定阈值，就可以将它标记成垃圾邮件。
下面尝试使用贝叶斯定理建模求。设定w为邮件中出现的词，b表示邮件是垃圾邮件，那么p(b|w)就是出现词w的情况下，邮件是垃圾邮件的概率。根据贝叶斯定理，```p(b|w)=p(b)*p(w|b)/p(w)```其中
p(b),p(w|b),p(w)可以通过对邮件训练样本做统计得到。具体方法，可以将收到的近5000封邮件（越多越好）分成正常邮件和垃圾邮件两个分组,根据每组邮件的个数和总邮件数的比值就可以得到p(b)。对分组内邮件的内容做分词，就可以得到p(w)和p(w|b)。这样就可以求出p(b|w)了。
有个问题需要注意，一个邮件会包含很多词，不能只因为一个词，就判断邮件是垃圾邮件。这里可以选择10个出现频率最多的词w1，w2，...,w10（也可以选择其他个数个词，需要根据具体的测试情况调整），计算出现这10个词的情况下的联合概率，p(b|w)=p(b|w1)p(b|w2)...p(b|w10)，如果其值高于某个阈值，就认为是垃圾邮件。

4.贝叶斯的其他应用

贝叶斯还有取多常见的应用，比如贝叶斯分类器（前东家就是使用贝叶斯分类器做文本的情感标签），贝叶斯网络等。下图是百度百科列出的贝叶斯的应用场景。
![design]({{ site.url }}/assets/20170801/baike.png)

5.贝叶斯背后的哲理

通过几个小例子，可以发现，只要涉及概率问题，都可以尝试着使用贝叶斯理论建模，能够解决问题的概率很大。那么为什么贝叶斯应用这么广呢？
再是回收站，看看贝叶斯定理```p(a|b)=p(a)*p(b|a)/p(b)=p(a)*[p(b|a)/p(b)]```,其中p(a)可以叫做“先验概率”（b事件发生之前a的概率),p(a|b)就是“后验概率”（发生b事件后，重新评估的a的概率）。有没有发现这和人类的认知很相似。人类就是在不断认识世界，刚开始对世界的了解比较肤浅，慢慢的通过发现一些新的现象，不断完善对世界的认知。

![design]({{ site.url }}/assets/20170801/evolve.png)

这也许就是原因。

